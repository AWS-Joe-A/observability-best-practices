# アプリケーションシグナルによるAPM

モダンなアプリケーション開発の世界では、パフォーマンスを最適化し、サービスレベル目標 (SLO) を達成することが、シームレスなユーザーエクスペリエンスを提供し、ビジネスの継続性を維持するために不可欠です。OpenTelemetry (OTel) 互換のアプリケーションパフォーマンスモニタリング (APM) 機能である Amazon CloudWatch Application Signals は、AWS 上で実行されているアプリケーションの監視とトラブルシューティングの方法を革新的に変えています。

CloudWatch Application Signals は、メトリクス、トレース、ログ、リアルユーザーモニタリング、合成モニタリングなど、複数のソースからのテレメトリデータを無縫接続して相関させることで、アプリケーションパフォーマンスモニタリングにホリスティックなアプローチを取っています。この統合されたアプローチにより、組織はアプリケーションのパフォーマンスに関する包括的な洞察を得て、問題の根本原因を特定し、潜在的な障害に対して積極的に対処できます。

CloudWatch Application Signals の主な利点の1つは、自動インストルメンテーションと追跡機能です。手動作業やカスタムコードは一切不要で、Application Signals は、AWS 上で実行されている各アプリケーションのパフォーマンスに関する最も重要なメトリクス (ボリューム、可用性、レイテンシー、障害、エラー) を表示する、事前構築された標準ダッシュボードを提供します。この合理化されたアプローチにより、カスタムダッシュボードの必要がなくなり、サービスオペレーターはアプリケーションの正常性とパフォーマンスを定義された SLO に対して迅速に評価できます。

![APM](./images/apm.png)
*図1: CloudWatch Application Signals がメトリクス、ログ、トレースを送信*

CloudWatch Application Signals は、組織に以下の機能を提供します。

1. **包括的なアプリケーションパフォーマンスモニタリング**: Application Signals は、メトリクス、トレース、ログ、リアルユーザーモニタリング、合成モニタリングからの洞察を組み合わせて、アプリケーションパフォーマンスの統合ビューを提供します。このホリスティックなアプローチにより、組織はパフォーマンスのボトルネックを特定し、根本原因を特定し、アプリケーションのパフォーマンスを最適化するための対策を講じることができます。

2. **自動インストルメンテーションと追跡**: 手動作業やカスタムコードは一切不要で、Application Signals は自動的にアプリケーションのパフォーマンスを定義された SLO に対して計装し、追跡します。この合理化されたアプローチにより、手動による計装と構成に関連するオーバーヘッドが削減され、組織はアプリケーション開発と最適化に集中できます。

3. **標準化されたダッシュボードと可視化**: Application Signals は、ボリューム、可用性、レイテンシー、障害、エラーなど、アプリケーションパフォーマンスに関する最も重要なメトリクスを表示する事前構築された標準ダッシュボードを提供します。この標準化されたビューにより、サービスオペレーターはアプリケーションの正常性とパフォーマンスを迅速に評価でき、的確な意思決定とプロアクティブな問題解決が可能になります。

4. **シームレスな相関とトラブルシューティング**: 複数のソースからのテレメトリデータを相関させることで、Application Signals はトラブルシューティングプロセスを簡素化します。サービスオペレーターは、相関するトレース、ログ、メトリクスにシームレスにドリルダウンして、パフォーマンスの問題や異常の根本原因を特定でき、平均復旧時間 (MTTR) を短縮し、アプリケーションの中断を最小限に抑えることができます。

5. **Container Insights との統合**: コンテナ化された環境でアプリケーションを実行する場合、CloudWatch Application Signals は Container Insights とシームレスに統合され、メモリ不足やコンテナポッドの高 CPU 使用率など、アプリケーションパフォーマンスに影響を与える可能性のあるインフラストラクチャ関連の問題を特定できます。

アプリケーションパフォーマンスモニタリングに CloudWatch Application Signals を活用するには、組織は以下の一般的な手順に従う必要があります。

1. **Application Signals の有効化**: AWS マネジメントコンソール、AWS コマンドラインインターフェイス (CLI)、または AWS SDK を使用してプログラムでアクセスし、AWS 上で実行されているアプリケーションの CloudWatch Application Signals を有効にします。

2. **サービスレベル目標 (SLO) の定義**: ビジネス要件と顧客の期待に合わせて、目標の可用性、最大レイテンシー、エラー閾値などの、アプリケーションの目的の SLO を設定し構成します。

3. **パフォーマンスの監視と分析**: Application Signals が提供する事前構築された標準ダッシュボードを利用して、定義された SLO に対するアプリケーションのパフォーマンスを監視します。メトリクス、トレース、ログ、リアルユーザーモニタリング、合成モニタリングデータを分析して、パフォーマンスの問題や異常を特定します。

4. **問題のトラブルシューティングと解決**: Application Signals のシームレスな相関機能を活用して、相関するトレース、ログ、メトリクスにドリルダウンし、パフォーマンスの問題や根本原因を迅速に特定して解決します。

5. **Container Insights との統合 (該当する場合)**: コンテナ化されたアプリケーションの場合は、CloudWatch Application Signals を Container Insights と統合し、アプリケーションパフォーマンスに影響を与える可能性のあるインフラストラクチャ関連の問題を特定します。

CloudWatch Application Signals は強力なアプリケーションパフォーマンスモニタリング機能を提供しますが、データボリュームとコスト管理が課題となる可能性があります。アプリケーションの複雑さとスケールが高まるにつれ、生成されるテレメトリデータの量が大幅に増加し、パフォーマンスに影響を与え、追加コストが発生する可能性があります。効率的で費用対効果の高いモニタリングソリューションを確保するには、データサンプリング戦略、保持ポリシー、コスト最適化手法の実装が必要になる場合があります。

さらに、アプリケーションパフォーマンスデータへのアクセス制御とデータセキュリティを適切に確保することが重要です。CloudWatch Application Signals は、AWS Identity and Access Management (IAM) を利用して細かいアクセス制御を行い、休止中と転送中のテレメトリデータに対して暗号化を適用することで、アプリケーションパフォーマンスデータの機密性と整合性を保護しています。

結論として、CloudWatch Application Signals は、AWS 上で実行されているアプリケーションのパフォーマンスモニタリングを革新的に変えています。自動インストルメンテーション、標準化されたダッシュボード、テレメトリデータのシームレスな相関により、Application Signals は組織がアプリケーションパフォーマンスを積極的に監視し、SLO 遵守を確保し、パフォーマンスの問題を迅速にトラブルシューティングして解決できるようにします。統合機能と OpenTelemetry 互換性により、CloudWatch Application Signals は、クラウド上のアプリケーションパフォーマンスモニタリングに包括的で将来に渡って対応可能なソリューションを提供します。
