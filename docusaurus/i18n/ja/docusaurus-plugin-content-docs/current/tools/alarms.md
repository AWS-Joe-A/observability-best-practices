# アラーム

Amazon CloudWatch アラームを使用すると、CloudWatch メトリクスとログに関するしきい値を定義し、CloudWatch で設定されたルールに基づいて通知を受け取ることができます。

**CloudWatch メトリクスに対するアラーム：**

CloudWatch アラームを使用すると、CloudWatch メトリクスにしきい値を定義し、メトリクスが範囲外になったときに通知を受け取ることができます。各メトリクスは複数のアラームをトリガーでき、各アラームには多くのアクションを関連付けることができます。CloudWatch メトリクスに基づいてメトリクスアラームを設定する方法は 2 つあります。

1. **静的しきい値**：静的しきい値は、メトリクスが違反してはならない厳格な制限を表します。通常の運用時の動作を理解するために、上限と下限のような静的しきい値の範囲を定義する必要があります。メトリクス値が静的しきい値を下回るか上回る場合、CloudWatch がアラームを生成するように設定できます。

2. **異常検出**：異常検出は一般的に、データの大多数から大きく逸脱し、正常な動作の明確な概念に適合しない稀なアイテム、イベント、または観測値として識別されます。CloudWatch の異常検出は、過去のメトリクスデータを分析し、期待値のモデルを作成します。期待値は、メトリクスの典型的な時間別、日別、週別のパターンを考慮に入れます。必要に応じて各メトリクスに異常検出を適用でき、CloudWatch は機械学習アルゴリズムを適用して、有効化された各メトリクスの上限と下限を定義し、メトリクスが期待値から外れた場合にのみアラームを生成します。

:::tip
静的しきい値は、ワークロードの特定のパフォーマンスブレークポイントやインフラストラクチャコンポーネントの絶対的な制限など、しっかりと理解しているメトリクスに最適です。
:::
:::info
特定のメトリクスの時間経過に伴うパフォーマンスが見えない場合や、負荷テストや異常なトラフィックの下でメトリクス値が観測されていない場合は、アラームに異常検出モデルを使用してください。
:::
![CloudWatch アラームの種類](../images/cwalarm1.png)

CloudWatch で静的および異常検出ベースのアラームを設定する方法については、以下の手順に従ってください。

[静的しきい値アラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/mericalarm)

[CloudWatch 異常検出ベースのアラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/adalarm)

:::info
アラーム疲労を軽減したり、生成されるアラームの数によるノイズを減らしたりするために、アラームを設定する 2 つの高度な方法があります：

1. **複合アラーム**：複合アラームには、他のアラームの状態を考慮するルール式が含まれます。複合アラームは、ルールのすべての条件が満たされた場合にのみ `ALARM` 状態になります。複合アラームのルール式で指定されるアラームには、メトリクスアラームと他の複合アラームを含めることができます。複合アラームは、[集約によるアラーム疲労との戦い](../signals/alarms/#fight-alarm-fatigue-with-aggregation)に役立ちます。

2. **メトリクス数式ベースのアラーム**：メトリクス数式を使用して、より意味のある KPI を構築し、それらにアラームを設定できます。複数のメトリクスを組み合わせて、組み合わせた使用率メトリクスを作成し、それにアラームを設定できます。
:::

以下の手順では、複合アラームとメトリクス数式ベースのアラームの設定方法を説明しています。

[複合アラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/compositealarm)

[メトリクス数式アラーム](https://aws.amazon.com/blogs/mt/create-a-metric-math-alarm-using-amazon-cloudwatch/)

**CloudWatch ログに対するアラーム**

CloudWatch メトリクスフィルターを使用して、CloudWatch ログに基づいてアラームを作成できます。メトリクスフィルターは、ログデータを数値の CloudWatch メトリクスに変換し、グラフ化したりアラームを設定したりできます。メトリクスを設定したら、CloudWatch ログから生成された CloudWatch メトリクスに対して、静的または異常検出ベースのアラームを使用できます。

[CloudWatch ログのメトリクスフィルター](https://aws.amazon.com/blogs/mt/quantify-custom-application-metrics-with-amazon-cloudwatch-logs-and-metric-filters/)の設定方法の例を見つけることができます。
