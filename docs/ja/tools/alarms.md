# アラーム

Amazon CloudWatch アラームを使用すると、CloudWatch メトリクスとログに対してしきい値を定義し、CloudWatch で構成されているルールに基づいて通知を受信できます。

**CloudWatch メトリクスのアラーム:**

CloudWatch アラームを使用すると、CloudWatch メトリクスに対してしきい値を定義し、メトリクスが範囲外に出たときに通知を受信できます。各メトリクスは複数のアラームをトリガーでき、各アラームには多数のアクションを関連付けることができます。CloudWatch メトリクスに基づいてメトリクスアラームを設定する方法には、次の 2 つの方法があります。

1. **静的しきい値**: 静的しきい値は、メトリクスが違反してはならない厳密な制限を表します。上限と下限などの静的しきい値の範囲を定義する必要があり、これにより通常の運用中の動作を理解できます。メトリクス値が静的しきい値の上下限を外れた場合、CloudWatch でアラームを生成するように構成できます。

2. **異常検知**: 異常検知は、データの大多数から大きく逸脱し、正常な動作の明確な概念に適合しないまれなアイテム、イベント、観測結果として一般的に識別されます。CloudWatch の異常検知は、過去のメトリクスデータを分析し、期待値のモデルを作成します。期待値には、メトリクスの典型的な時間帯、日次、週次のパターンが考慮されます。必要に応じて各メトリクスに異常検知を適用でき、CloudWatch は機械学習アルゴリズムを適用して、有効になっている各メトリクスの上限と下限を定義し、メトリクスが期待値の範囲外に出た場合にのみアラームを生成します。

!!! tip
	静的しきい値は、ワークロードの特定のパフォーマンスのブレークポイントや、インフラストラクチャコンポーネントの絶対制限など、確固たる理解のあるメトリクスに最適です。
	
!!! success
	特定のメトリクスの時間経過に伴うパフォーマンスが不明な場合や、メトリクス値が負荷テストや異常トラフィック下で以前に観測されなかった場合は、アラームで異常検知モデルを使用してください。

![CloudWatch アラームの種類](../images/cwalarm1.png)

以下の手順では、CloudWatch での静的および異常ベースのアラームの設定方法を説明しています。

[静的しきい値アラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/mericalarm)

[CloudWatch 異常検知ベースのアラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/adalarm)

!!! success
	アラーム疲労の軽減やアラームのノイズの削減のために、アラームを構成する際に次の 2 つの高度な方法があります。

	1. **コンポジットアラーム**: コンポジットアラームには、他の作成済みアラームのアラーム状態を考慮に入れたルール式が含まれます。ルールのすべての条件が満たされた場合にのみ、コンポジットアラームが `ALARM` 状態になります。コンポジットアラームのルール式で指定されるアラームには、メトリクスアラームと他のコンポジットアラームを含めることができます。コンポジットアラームは、[集約によるアラーム疲労との戦い](../../signals/alarms/#fight-alarm-fatigue-with-aggregation) に役立ちます。

	2. **メトリクス数式に基づくアラーム**: メトリクス数式を使用すると、より意味のある KPI を構築し、そのアラームを設定できます。複数のメトリクスを組み合わせ、統合利用率メトリクスを作成し、そのアラームを設定できます。

以下の手順では、コンポジットアラームとメトリクス数式ベースのアラームの設定方法を説明しています。

[コンポジットアラーム](https://catalog.us-east-1.prod.workshops.aws/workshops/31676d37-bbe9-4992-9cd1-ceae13c5116c/en-US/alarms/compositealarm)

[メトリクス数式アラーム](https://aws.amazon.com/blogs/mt/create-a-metric-math-alarm-using-amazon-cloudwatch/)

**CloudWatch ログのアラーム**

CloudWatch Logs を使用すると、CloudWatch メトリクスフィルタを使用してアラームを作成できます。メトリクスフィルタはログデータを数値の CloudWatch メトリクスに変換し、グラフ化したりアラームを設定したりできます。メトリクスの設定が完了したら、CloudWatch ログから生成された CloudWatch メトリクスに対して、静的または異常ベースのアラームを使用できます。

[CloudWatch ログのメトリクスフィルタの設定](https://aws.amazon.com/blogs/mt/quantify-custom-application-metrics-with-amazon-cloudwatch-logs-and-metric-filters/)の例を参照できます。
