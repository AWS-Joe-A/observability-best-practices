# なぜオブザーバビリティが必要なのか

YouTube の [Developing an Observability Strategy](https://www.youtube.com/watch?v=Ub3ATriFapQ) をご覧ください。

## 本当に重要なことは?

職場で行うすべてのことは、組織のミッションと整合性がとれている必要があります。雇用されている私たちはみな、組織のミッションの達成とビジョンの実現に向けて働いています。Amazon のミッションは次のとおりです。

> Amazon は、地球で最も顧客中心の会社、最高の雇用主、最も安全な職場を目指しています。 

— [Amazon について](https://www.aboutamazon.com/about-us)

IT において、すべてのプロジェクト、デプロイ、セキュリティ対策、最適化は、ビジネスの成果に向けて機能する必要があります。当然のことのようである一方で、ビジネスに価値を付加しない作業は行うべきではない、ということです。ITIL の言葉を借りれば:

> すべての変更はビジネス価値を提供する必要がある

— ITIL サービス移行、AXELOS、2011 年、44 ページ 
— [クラウドにおける変更管理のホワイトペーパー](https://docs.aws.amazon.com/whitepapers/latest/change-management-in-the-cloud/change-management-in-the-cloud.html) を参照

ミッションとビジネス価値は、行うすべてのことの基準となるため重要です。
オブザーバビリティにはさまざまなメリットがあります。

- 可用性の向上
- 信頼性の向上 
- アプリケーションの健全性とパフォーマンスの理解
- コラボレーションの改善
- 問題の予防的検知
- 顧客満足度の向上
- 上市までの期間の短縮
- 運用コストの削減
- 自動化

これらのメリットはすべて、ビジネス価値の提供という共通点があります。ビジネス価値は、顧客または組織に直接的あるいは間接的にもたらされます。
オブザーバビリティを考える際、アプリケーションがビジネス価値を提供しているかどうかを判断することがすべてにおいて重要です。

つまり、オブザーバビリティは、ビジネス価値の提供に貢献するものを測定し、ビジネスの成果に焦点を当てる必要があります。リスクがある場合は、顧客が何を必要としているかを考える必要があります。

## どこから始めればいいですか?

重要なことがわかったところで、何を測定する必要があるかを考える必要があります。Amazon では、お客様から逆算することから始めます。

> 私たちは内部的にサービスの改善に駆り立てられ、恩恵や機能を追加する前に。お客様への価値を高め、価格を下げる前に。必要に迫られる前に発明する。

- ジェフ・ベゾス、[2012 年株主総会](https://s2.q4cdn.com/299287126/files/doc_financials/annual/2012-Shareholder-Letter.pdf)

簡単な例として、EC サイトを使用しましょう。まず、オンラインで商品を購入する際に、お客様として何が欲しいかを考えてください。すべての人にとって同じとは限りませんが、おそらく以下のようなことを気にかけているでしょう。

- 配送
- 価格
- セキュリティ 
- ページ速度
- 検索 (探している商品が見つかるか)

お客様が何を大切にしているかがわかったら、それらを測定し、ビジネスの結果にどのように影響するかを確認できるようになります。ページ速度は直接的にコンバージョン率や検索エンジンのランキングに影響します。2017 年の調査では、モバイルユーザーの 53% が 3 秒以上の読み込み時間の場合にそのページを放棄することが示されています。もちろん、ページ速度の重要性を示す研究は多数あります。測定する必要のある明白な指標ですが、コンバージョンへの測定可能な影響があるため、測定と対応が必要です。そのデータを使用して改善できます。

## 逆算で考える

お客様が何に価値を置いているか、すべてを知ることはできません。この文章を読んでいるあなたは、技術系の役割についていると思います。組織のステークホルダーと話をする必要があります。これは必ずしも簡単なことではありませんが、重要なことを測定できているか確認するために不可欠です。

EC サイトを例に考えてみましょう。今回は検索についてです。顧客が製品を購入するためにはその製品を検索できなければならない、というのは自明のことですが、[Forrester Research のレポート](https://www.forrester.com/report/MustHave+eCommerce+Features/-/E-RES89561) によると、訪問者の 43% が即座に検索ボックスに移動し、検索経由の顧客は非検索経由の顧客よりも 2~3 倍購入に結びつきやすいことがわかっています。検索は本当に重要で、うまく機能させる必要があり、監視する必要があります。ある検索に対して結果が全く得られないといったことが起き、単純なパターンマッチングから自然言語処理へ移行する必要があるかもしれません。これはビジネスの結果を監視し、顧客体験を改善するための行動につなげる例です。  

Amazon では次のようにしています。

> 私たちは顧客を深く理解し、彼らの痛みの原因から逆算して迅速に革新を開発し、彼らの人生に意味のあるソリューションを生み出そうと努めています。

— Daniel Slater - Worldwide Lead, Culture of Innovation, AWS in [Elements of Amazon’s Day 1 Culture](https://aws.amazon.com/executive-insights/content/how-amazon-defines-and-operationalizes-a-day-1-culture/)

私たちは顧客から始め、ニーズから逆算しています。これがビジネスで成功する唯一のアプローチというわけではありませんが、オブザーバビリティにとっては良いアプローチです。ステークホルダーと連携して、顧客にとって何が重要かを理解し、そこから逆算していきます。  

付加価値として、顧客やステークホルダーにとって重要なメトリクスを収集し、リアルタイムのダッシュボードで可視化できれば、レポートの作成や「ランディングページの読み込みにどのくらいの時間がかかっているか」「ウェブサイトの運用にどのくらいコストがかかっているか」といった質問への回答が不要となり、ステークホルダーや経営陣がこの情報をセルフサービスで入手できるようになります。  

これらはアプリケーションにとって**本当に重要な**高レベルのメトリクスであり、ほぼ常に問題がある最良の指標でもあります。 たとえば、通常より受注数が少ないことを示すアラートは、おそらく顧客に影響を与えている問題があることを意味しています。サーバーのボリュームがほぼ満杯であることや、特定のサービスで 5xx エラーが多数発生していることを示すアラートは、修正が必要なものかもしれませんが、それでも顧客への影響を理解して優先順位を決定する必要があります。これには時間がかかる場合があります。  

これらの高レベルなビジネスメトリクスを測定することで、顧客に影響を与える問題は簡単に特定できます。これらのメトリクスは**何が**起こっているかを表しています。その他のメトリクスやトレース、ログなどの他の形のオブザーバビリティは、**なぜ**それが起こっているのかを表しており、これを修正または改善するために何ができるかを導き出すことにつながります。

## 観測するもの

顧客にとって重要なことがわかったので、重要業績評価指標 (KPI) を特定できます。これらはビジネスの成果がリスクにさらされているかどうかを教えてくれる上位のメトリクスです。また、それらの KPI に影響を与える可能性のある多くの異なるソースからの情報を収集する必要があります。これは、それらの KPI に影響を与える可能性のあるメトリクスについて考え始める必要がある場所です。前に議論したように、5xx エラーの数は影響を示すものではありませんが、KPI に影響を与える可能性があります。ビジネスの成果に影響を与えるものから、ビジネスの成果に影響を与える可能性のあるものへと逆向きに作業を進めます。

収集する必要があるものがわかったら、KPI とそれらの KPI に影響を与える可能性のある関連メトリクスを測定するために使用できるメトリクスを提供してくれる情報ソースを特定する必要があります。これが観測するものの基本です。

このデータは、メトリクス、ログ、トレースから得られる可能性が高いでしょう。このデータがあると、成果がリスクにさらされたときにアラートを出すことができます。

その後、影響を評価し、問題を修正しようと試みることができます。ほとんどの場合、このデータは、分離された技術的メトリクス(CPU やメモリなど)よりも前に、問題があることを教えてくれます。

オブザーバビリティを反応的に使用して、ビジネスの成果に影響を与えている問題を修正したり、データを先取りして顧客の検索エクスペリエンスを改善するなどのことを行うことができます。

## まとめ

CPU、RAM、ディスク容量、その他の技術的なメトリクスは、スケーリング、パフォーマンス、容量、コストの面で重要ですが、アプリケーションの実行状況や顧客体験の洞察を示すものではありません。

重要なのはお客様であり、監視すべきはお客様の体験です。

そのため、お客様の要件から逆算し、ステークホルダーと協力して、重要な KPI とメトリクスを確立する必要があります。
