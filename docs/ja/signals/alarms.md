# アラーム

アラームとは、プローブ、モニター、または特定のしきい値を超えるか下回る値の変化の状態を指します。簡単な例として、ディスクがいっぱいになったときや Web サイトがダウンしたときにメールを送信するアラームがあります。より高度なアラームは完全にプログラムで制御されており、オートスケーリングやサーバークラスタの作成などの複雑な対話を駆動するために使用されます。

ただし、ユースケースに関係なく、アラームはメトリクスの現在の*状態*を示します。この状態は、システムによって `OK`、`WARNING`、`ALERT`、`NO DATA` のいずれかになります。

アラームはこの状態を一定期間反映し、タイムシリーズの上に構築されます。したがって、それらはタイムシリーズ*から*導出されます。この下のグラフは、2つのアラームを示しています。1つは警告しきい値のアラームで、もう1つはこのタイムシリーズ全体の平均値を示すアラームです。このグラフが示すトラフィック量で、警告しきい値のアラームは、定義された値を下回ると違反状態になる必要があります。

![2つのアラームを持つタイムシリーズ](../images/cwalarm2.png)

!!! info
	アラームの目的は、アクション(人間またはプログラム)をトリガーするか、情報提供(しきい値の違反)のいずれかです。アラームはメトリクスのパフォーマンスを洞察します。

## アクション可能なものに対するアラートの設定

アラーム疲労とは、大量のアラートを受信することでそれらを無視するようになることです。これは、適切にモニタリングされているシステムの兆候ではありません。むしろ、これはアンチパターンです。

!!! success
	アクション可能なものに対してアラームを設定し、常に[目的](../../guides/#monitor-what-matters)から逆算してください。

例えば、高速なレスポンスタイムが必要な Web サイトを運用している場合は、レスポンスタイムが特定のしきい値を超えたときにアラートが配信されるように設定します。また、パフォーマンスの低下が高い CPU 使用率と関連していることを特定した場合は、このデータポイントに対して事前に*プロアクティブに*アラートを設定します。ただし、アウトカムに*危険が及ばない*場合には、環境内の*すべて*の CPU 使用率に対してアラートを設定する必要はないかもしれません。 

!!! success
	アラートがアクションをトリガーしたり通知する必要がない場合は、そのアラートを設定する必要はありません。不要なアラートの通知は削除する必要があります。

## 「すべてOKアラーム」に注意

同様に、一般的なパターンとして、オペレーターが絶え間なくアラートを受け取ることに慣れすぎているため、突然静かになったときだけ気づく「すべてOKアラーム」があります。これは非常に危険なモードで運用することであり、[運用上の卓越性](../../faq/#運用上の卓越性とは)に反するパターンです。 

!!! warning
	「すべてOKアラーム」は通常、人間による解釈が必要です! これにより、セルフヒーリングアプリケーションなどのパターンが不可能になります。[^1]

## 集約によるアラーム疲労の軽減

オブザーバビリティは技術的な問題ではなく、人間的な問題です。そのため、アラーム戦略は更なるアラームの作成よりも、アラームの削減に焦点を当てるべきです。テレメトリ収集を実装するにつれて、環境からのアラートが増えるのは自然なことです。しかし、[対処可能なものだけをアラートする](../../signals/alarms/#alert-on-things-that-are-actionable)よう注意する必要があります。アラートの原因となった条件が対処できないものであれば、報告する必要はありません。

これは例を示すのが一番わかりやすいでしょう。バックエンドに単一のデータベースを使用する 5 つの Web サーバーがある場合、データベースがダウンしたときに Web サーバーに何が起こるでしょうか? 多くの人の答えは、少なくとも 6 つのアラートが発生するということです。Web サーバーからの*5* つと、データベースからの*1* つです!

![6 つのアラーム](../images/alarm3.png)

しかし、配信する意味のあるアラートは 2 つだけです。

1. Web サイトがダウンしている
2. データベースが原因である

![2 つのアラーム](../images/alarm4.png)

!!! success
	アラートを集約することで、人々が理解しやすくなり、次に実行手順書や自動化を作成しやすくなります。

## 既存の ITSM とサポートプロセスを利用する

監視およびオブザーバビリティプラットフォームに関係なく、それらは現在のツールチェーンと統合する必要があります。

!!! success
	アラートからこれらのツールへのプログラムによる統合を使用して、トラブルチケットと問題を作成し、人的作業を削減し、プロセスを効率化します。

これにより、[DORA メトリクス](https://en.wikipedia.org/wiki/DevOps)などの重要な運用データを導出できます。


[^1]: このパターンの詳細については、 https://aws.amazon.com/blogs/apn/building-self-healing-infrastructure-as-code-with-dynatrace-aws-lambda-and-aws-service-catalog/ を参照してください。
